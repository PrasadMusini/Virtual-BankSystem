<div class="box mat-elevation-z8">
    <mat-toolbar>Szczegóły kredytu</mat-toolbar>
    <div *ngIf="credit">
        <table class="table table-hover">
            <tr>
                <td class="divider">ID: </td>
                <td>{{ credit.id }}</td>
            </tr>
            <tr>
                <td class="divider">Wpłacono: </td>
                <td>{{ credit.balancePaid | currency: credit.currency}}</td>
            </tr>
            <tr>
                <td class="divider">Wysokość raty: </td>
                <td>{{ credit.installmentAmount | currency: credit.currency}}</td>
            </tr>
            <tr>
                <td class="divider">Wysokość kredytu: </td>
                <td>{{ credit.totalBalance | currency: credit.currency }}</td>
            </tr>
            <tr>
                <td class="divider">Waluta: </td>
                <td>{{ credit.currency }}</td>
            </tr>
            <tr>
                <td class="divider">Status: </td>
                <td>
                    <p *ngIf="credit.creditStatus.creditType === 'ACTIVE'">Aktywny</p>
                    <p *ngIf="credit.creditStatus.creditType === 'AWAITING'">Oczekujący</p>
                    <p *ngIf="credit.creditStatus.creditType === 'CANCELED'">Usunięty</p>
                    <p *ngIf="credit.creditStatus.creditType === 'PAID'">Spłacony</p>
                </td>
            </tr>


        </table>
        <mat-toolbar>Wpłaty <span *ngIf="credit.creditStatus.creditType==='ACTIVE'" class="ml-auto"><button
                    mat-raised-button (click)="createInstallment()" color="primary">Opłać</button></span>
        </mat-toolbar>
        <div [hidden]="isLoading || (installments && installments.data.length === 0)">
            <table mat-table [dataSource]="installments">

                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef> Id </th>
                    <td mat-cell *matCellDef="let element"> {{element.id}}</td>
                </ng-container>

                <ng-container matColumnDef="totalBalance">
                    <th mat-header-cell *matHeaderCellDef> Wysokość kredytu </th>
                    <td mat-cell *matCellDef="let element"> {{element.totalBalance}}
                    </td>
                </ng-container>

                <ng-container matColumnDef="totalInstallmentCount">
                    <th mat-header-cell *matHeaderCellDef> Ilość rat </th>
                    <td mat-cell *matCellDef="let element"> {{element.totalInstallmentCount}}
                    </td>
                </ng-container>

                <ng-container matColumnDef="currency">
                    <th mat-header-cell *matHeaderCellDef> Waluta </th>
                    <td mat-cell *matCellDef="let element"> {{element.currency}}
                    </td>
                </ng-container>

                <ng-container matColumnDef="accept">
                    <th mat-header-cell *matHeaderCellDef> Akceptuj </th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-raised-button class="bg-success text-white"
                            (click)="acceptCredit(element.id)">Akceptuj</button>
                    </td>
                </ng-container>

                <ng-container matColumnDef="reject">
                    <th mat-header-cell *matHeaderCellDef> Odrzuć </th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-raised-button class="bg-danger text-white"
                            (click)="rejectCredit(element.id)">Odrzuć</button>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="installmentColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: installmentColumns;"></tr>
            </table>
            <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
        </div>
        <div class="col-12" *ngIf="installments && installments.data.length === 0">
            Brak wpłat
        </div>
    </div>
    <div *ngIf="!credit">
        <mat-spinner></mat-spinner>
    </div>
</div>